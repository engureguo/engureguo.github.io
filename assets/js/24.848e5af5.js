(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{305:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"cmake-tutorials-note"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cmake-tutorials-note"}},[t._v("#")]),t._v(" cmake tutorials note")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.bilibili.com/video/BV14s4y1g7Zj",target:"_blank",rel:"noopener noreferrer"}},[t._v("dabing cmake"),s("OutboundLink")],1),t._v(", "),s("a",{attrs:{href:"https://subingwen.cn/cmake/CMake-primer/",target:"_blank",rel:"noopener noreferrer"}},[t._v("doc-1"),s("OutboundLink")],1),t._v(", "),s("a",{attrs:{href:"https://subingwen.cn/cmake/CMake-advanced",target:"_blank",rel:"noopener noreferrer"}},[t._v("doc-2"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"快速上手"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速上手"}},[t._v("#")]),t._v(" 快速上手")]),t._v(" "),s("p",[s("strong",[t._v("gcc 步骤")]),t._v(":")]),t._v(" "),s("ol",[s("li",[t._v("预处理")]),t._v(" "),s("li",[t._v("编译（编译器）")]),t._v(" "),s("li",[t._v("汇编（汇编器）")]),t._v(" "),s("li",[t._v("链接（链接器）")])]),t._v(" "),s("p",[t._v("如果有很多文件（比如超过 10 个）需要在一起编译，那么使用 gcc 命令似乎很棘手，通常我们会使用 makefile 或 cmake 工具辅助编译。")]),t._v(" "),s("p",[t._v("步骤：")]),t._v(" "),s("ol",[s("li",[t._v("create file "),s("code",[t._v("CmakeLists.txt")])]),t._v(" "),s("li",[t._v("execute cmd "),s("code",[t._v("cmake <path>")]),t._v(" to generate "),s("code",[t._v("Makefile")]),t._v("（2nd path can be relative path of "),s("code",[t._v("CMakeLists.txt")]),t._v("）")]),t._v(" "),s("li",[t._v("use cmd "),s("code",[t._v("make")]),t._v(" to obtain executable file")])]),t._v(" "),s("h3",{attrs:{id:"cmake-安装与基本使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cmake-安装与基本使用"}},[t._v("#")]),t._v(" cmake 安装与基本使用")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" cmake\n\ncmake "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--version")]),t._v("\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# centos")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# https://stackoverflow.com/questions/55345373/how-to-install-gcc-g-8-on-centos#comment136335547_66016318")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" dnf groupinstall "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Development Tools"')]),t._v("\n")])])]),s("p",[t._v("create file "),s("code",[t._v("CMakeLists.txt")]),t._v(" and fill with:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 定义最小的 cmake 版本，可选")]),t._v("\ncmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 定义项目名")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("helloworld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定最终可执行文件以及源文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 参数1：可执行文件名子")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 参数2：原文件列表，如果有多个可使用 space 或 ; 间隔")]),t._v("\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp add"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp sub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp mul"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp div"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意：指定源文件时无需指定 .h 文件")]),t._v("\n")])])]),s("p",[t._v("利用 cmake 进行编译")]),t._v(" "),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-txt"}},[s("code",[t._v("$ cmake .\n.\n├── add.cpp\n├── CMakeCache.txt\n├── CMakeFiles\n├── cmake_install.cmake\n├── CMakeLists.txt\n├── div.cpp\n├── head.h\n├── main.cpp\n├── Makefile\n├── mul.cpp\n└── sub.cpp\n")])])]),s("hr"),t._v(" "),s("p",[s("strong",[t._v("推荐")]),t._v("另一种方式：将所有 cmake 和 make 中间产物统一放在一个目录下")]),t._v(" "),s("blockquote",[s("p",[t._v("尝试这种方式之间需要删掉上边一步产生的所有中间产物")]),t._v(" "),s("p",[s("code",[t._v("rm -rf CMakeFiles cmake_install.cmake CMakeCache.txt Makefile")])])]),t._v(" "),s("ol",[s("li",[t._v("创建 "),s("code",[t._v("build")]),t._v(" 目录并 "),s("code",[t._v("cd")]),t._v(" 进入它")]),t._v(" "),s("li",[t._v("执行命令 "),s("code",[t._v("cmake ..")])]),t._v(" "),s("li",[t._v("然后所有的编译中间产物都出现在了 build 目录中")])]),t._v(" "),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-txt"}},[s("code",[t._v(".\n├── add.cpp\n├── build\n├── CMakeLists.txt\n├── div.cpp\n├── head.h\n├── main.cpp\n├── mul.cpp\n└── sub.cpp\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[t._v("然后执行 "),s("code",[t._v("make")]),t._v(" 命令，然后可以得到 "),s("code",[t._v("app")]),t._v(" 可执行文件")])]),t._v(" "),s("h3",{attrs:{id:"cmake-添加变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cmake-添加变量"}},[t._v("#")]),t._v(" cmake - 添加变量")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("helloworld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1.指定标准版本(auto keyword is supported in std11+)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CMAKE_CXX_STANDARD "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2. 定义变量")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SRC_LIST main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp add"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp sub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp mul"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp div"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# same as")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# set(SRC_LIST main.cpp;add.cpp;sub.cpp;mul.cpp;div.cpp)")]),t._v("\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("第三种方式：通过为 cmake 命令添加参数添加")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("cmake "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-DCMAKE_CXX_STANDARD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v("\n")])])]),s("hr"),t._v(" "),s("p",[t._v("另一个宏 "),s("code",[t._v("EXECUTABLE_OUTPUT_PATH")]),t._v(" 用来指定生成的可执行文件的路径。如果路径不存在会自动被创建")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nSET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HOME "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("home"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("eugene"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tools"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXECUTABLE_OUTPUT_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("HOME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("hr"),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("helloworld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 定义标准库版本")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CMAKE_CXX_STANDARD "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SRC_LIST main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp add"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp sub"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp mul"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp div"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# set(SRC_LIST main.cpp;add.cpp;sub.cpp;mul.cpp;div.cpp)")]),t._v("\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HOME "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("home"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("eugene"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXECUTABLE_OUTPUT_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("HOME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("aa"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bb"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-txt"}},[s("code",[t._v("➜  build cmake .. && make\n-- The C compiler identification is GNU 11.4.0\n-- The CXX compiler identification is GNU 11.4.0\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Check for working C compiler: /usr/bin/cc - skipped\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Check for working CXX compiler: /usr/bin/c++ - skipped\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/eugene/Documents/cmake_workspace/01proj_helloworld/build\n[ 16%] Building CXX object CMakeFiles/app.dir/main.cpp.o\n[ 33%] Building CXX object CMakeFiles/app.dir/add.cpp.o\n[ 50%] Building CXX object CMakeFiles/app.dir/sub.cpp.o\n[ 66%] Building CXX object CMakeFiles/app.dir/mul.cpp.o\n[ 83%] Building CXX object CMakeFiles/app.dir/div.cpp.o\n[100%] Linking CXX executable /home/eugene/aa/bb/app/app\n[100%] Built target app\n➜  build cmake .. && make\n-- The C compiler identification is GNU 11.4.0\n-- The CXX compiler identification is GNU 11.4.0\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Check for working C compiler: /usr/bin/cc - skipped\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Check for working CXX compiler: /usr/bin/c++ - skipped\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/eugene/Documents/cmake_workspace/01proj_helloworld/build\n[ 16%] Building CXX object CMakeFiles/app.dir/main.cpp.o\n[ 33%] Building CXX object CMakeFiles/app.dir/add.cpp.o\n[ 50%] Building CXX object CMakeFiles/app.dir/sub.cpp.o\n[ 66%] Building CXX object CMakeFiles/app.dir/mul.cpp.o\n[ 83%] Building CXX object CMakeFiles/app.dir/div.cpp.o\n[100%] Linking CXX executable /home/eugene/aa/bb/app/app\n[100%] Built target app\n➜  build /home/eugene/aa/bb/app/app\na = 20, b = 12\na + b = 32\na - b = 8\na * b = 240\na / b = 1.666667\n➜  build\n➜  build\n")])])]),s("p",[t._v("动手尝试：change CMAKE_CXX_STANDARD value from 11 to 98, and see what'll happen.")]),t._v(" "),s("h3",{attrs:{id:"cmake-搜索文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cmake-搜索文件"}},[t._v("#")]),t._v(" cmake - 搜索文件")]),t._v(" "),s("p",[t._v("上一节中我们使用 set 命令指定了所有的源文件，但当文件很多时这种方法太繁琐，我们可以使用搜索命令自动扫描某个目录下的文件")]),t._v(" "),s("p",[t._v("方式一："),s("code",[t._v("aux_source_directory")]),t._v(" 命令")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("helloworld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CMAKE_CXX_STANDARD "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# set(SRC_LIST main.cpp add.cpp sub.cpp mul.cpp div.cpp)")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 搜索指定目录下的所有文件并将其赋值给一个变量")]),t._v("\naux_source_directory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用变量")]),t._v("\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("blockquote",[s("p",[s("code",[t._v("PROJECT_SOURCE_DIR")]),t._v(" 这个变量所指的目录是我们使用 cmake 命令时传递的第一个参数所指的目录")])]),t._v(" "),s("p",[t._v("方式二："),s("code",[t._v("file")]),t._v(" 命令，功能比较强大")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("helloworld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CMAKE_CXX_STANDARD "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# set(SRC_LIST main.cpp add.cpp sub.cpp mul.cpp div.cpp)")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据 ${PROJECT_SOURCE_DIR}/*.cpp 规则搜索所有文件(无递归)并将他们保存在变量 SRC_LIST 中")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("a",{attrs:{href:"https://cmake.org/cmake/help/latest/command/file.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("file — CMake 3.29.0-rc1 Documentation"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"指定头文件目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指定头文件目录"}},[t._v("#")]),t._v(" 指定头文件目录")]),t._v(" "),s("p",[t._v("创建两个目录："),s("code",[t._v("include")]),t._v(" 用来存放所有头文件；"),s("code",[t._v("src")]),t._v(" 用来存放所有源文件")]),t._v(" "),s("p",[t._v("结构为")]),t._v(" "),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-txt"}},[s("code",[t._v("➜  01proj_helloworld tree -L 2\n.\n├── build\n│   ├── app\n│   ├── CMakeCache.txt\n│   ├── CMakeFiles\n│   ├── cmake_install.cmake\n│   └── Makefile\n├── CMakeLists.txt\n├── include\n│   └── head.h\n└── src\n    ├── add.cpp\n    ├── div.cpp\n    ├── main.cpp\n    ├── mul.cpp\n    └── sub.cpp\n")])])]),s("p",[t._v("编写 "),s("code",[t._v("CMakeLists.txt")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("helloworld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CMAKE_CXX_STANDARD "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# file(GLOB SRC_LIST ${PROJECT_SOURCE_DIR}/*.cpp)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("在 build 目录中进行编译，发现出错了")]),t._v(" "),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-txt"}},[s("code",[t._v('➜  build cmake .. && make\n-- The C compiler identification is GNU 11.4.0\n-- The CXX compiler identification is GNU 11.4.0\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Check for working C compiler: /usr/bin/cc - skipped\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Check for working CXX compiler: /usr/bin/c++ - skipped\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/eugene/Documents/cmake_workspace/01proj_helloworld/build\n[ 16%] Building CXX object CMakeFiles/app.dir/src/add.cpp.o\n/home/eugene/Documents/cmake_workspace/01proj_helloworld/src/add.cpp:2:10: fatal error: head.h: No such file or directory\n    2 | #include "head.h"\n      |          ^~~~~~~~\ncompilation terminated.\nmake[2]: *** [CMakeFiles/app.dir/build.make:76: CMakeFiles/app.dir/src/add.cpp.o] Error 1\nmake[1]: *** [CMakeFiles/Makefile2:83: CMakeFiles/app.dir/all] Error 2\nmake: *** [Makefile:91: all] Error 2\n➜  build\n')])])]),s("p",[t._v("原因："),s("code",[t._v("add.cpp")]),t._v(" 找不到头文件")]),t._v(" "),s("p",[t._v("解决方法")]),t._v(" "),s("ol",[s("li",[t._v("修改 "),s("code",[t._v("add.cpp")]),t._v(" 的 "),s("code",[t._v('#include "head.h"')]),t._v("为 "),s("code",[t._v('#include "../include/head.h"')]),t._v(": 如果文件太多，那么修改起来很麻烦")]),t._v(" "),s("li",[t._v("（推荐） 指定 header 目录，使用命令： "),s("code",[t._v("include_directories(${PROJECT_SOURCE_DIR}/include)")])])]),t._v(" "),s("p",[t._v("最终的 "),s("code",[t._v("CMakeLists.txt")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("helloworld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CMAKE_CXX_STANDARD "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定头文件所在目录")]),t._v("\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("include"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"基于-cmake-构建库和使用库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基于-cmake-构建库和使用库"}},[t._v("#")]),t._v(" 基于 cmake 构建库和使用库")]),t._v(" "),s("p",[t._v("项目："),s("code",[t._v("02project_lib")])]),t._v(" "),s("p",[t._v("创建项目有哪些目的？")]),t._v(" "),s("ol",[s("li",[t._v("构建可执行文件")]),t._v(" "),s("li",[t._v("组合源文件到一个二进制文件，也称为库，有动态库和静态库之分")])]),t._v(" "),s("h3",{attrs:{id:"创建动态库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建动态库"}},[t._v("#")]),t._v(" 创建动态库")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mylib"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CMAKE_CXX_STANDARD "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("include"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# add_executable(app ${SRC_LIST})")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用 add_library 命令")]),t._v("\nadd_library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mycalc SHARED $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-txt"}},[s("code",[t._v("$ tree -L 2\n.\n├── build\n│   ├── CMakeCache.txt\n│   ├── CMakeFiles\n│   ├── cmake_install.cmake\n│   ├── libmycalc.so          # 动态库\n│   └── Makefile\n├── CMakeLists.txt\n├── include\n│   └── head.h\n└── src\n    ├── add.cpp\n    ├── div.cpp\n    ├── mul.cpp\n    └── sub.cpp\n")])])]),s("blockquote",[s("p",[t._v("dynamic library have executable permission while static library do not have!")])]),t._v(" "),s("h3",{attrs:{id:"创建静态库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建静态库"}},[t._v("#")]),t._v(" 创建静态库")]),t._v(" "),s("p",[t._v("利用上一节代码，只需改动一个关键字")]),t._v(" "),s("p",[s("code",[t._v("CMakeLists.txt")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#add_library(mycalc SHARED ${SRC_LIST})")]),t._v("\nadd_library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mycalc STATIC $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-txt"}},[s("code",[t._v(".\n├── build\n│   ├── CMakeCache.txt\n│   ├── CMakeFiles\n│   ├── cmake_install.cmake\n│   ├── libmycalc.a         # 静态库\n│   └── Makefile\n├── CMakeLists.txt\n├── include\n│   └── head.h\n└── src\n    ├── add.cpp\n    ├── div.cpp\n    ├── mul.cpp\n    └── sub.cpp\n")])])]),s("hr"),t._v(" "),s("p",[t._v("可以使用宏 "),s("code",[t._v("LIBRARY_OUTPUT_PATH")]),t._v(" 指定动态库或静态库的输出目录")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mylib"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CMAKE_CXX_STANDARD "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("include"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# set library output path")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LIBRARY_OUTPUT_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lib"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nadd_library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mycalc STATIC $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"链接静态库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#链接静态库"}},[t._v("#")]),t._v(" 链接静态库")]),t._v(" "),s("p",[t._v("准备目录（项目： "),s("code",[t._v("03proj_use_static_lib")]),t._v("）")]),t._v(" "),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-txt"}},[s("code",[t._v(".\n├── build\n├── CMakeLists.txt\n├── include\n│   └── head.h\n├── lib\n│   └── libmycalc.a\n└── src\n    └── main.cpp\n")])])]),s("p",[t._v("链接静态库")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("project"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("helloworld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CMAKE_CXX_STANDARD "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("include"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# way 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# link_libraries(${PROJECT_SOURCE_DIR}/lib/libmycalc.a) # specify a staic lib path")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# way 2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# link_libraries(libmycalc.a)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# link_directories(${PROJECT_SOURCE_DIR}/lib) # specify lib directories")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# way 3")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# link_libraries(mycalc)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# link_directories(${PROJECT_SOURCE_DIR}/lib) # specify lib directories")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# way 4")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB LIB_LIST $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lib"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nlink_libraries"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LIB_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# support multiple staic lib paths")]),t._v("\n\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("注意")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("link_libraries()")]),t._v(" and "),s("code",[t._v("link_directories()")]),t._v(" 命令支持多个参数")]),t._v(" "),s("li",[s("code",[t._v("link_libraries()")]),t._v(" 只能链接静态库")]),t._v(" "),s("li",[s("code",[t._v("link_directories()")]),t._v(" 指定要链接库所在的目录")])]),t._v(" "),s("h3",{attrs:{id:"链接动态库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#链接动态库"}},[t._v("#")]),t._v(" 链接动态库")]),t._v(" "),s("p",[t._v("除了在项目中引入静态库，很多时候也会使用一些标准的或者第三方提供的一些动态库，关于"),s("strong",[t._v("动态库的制作、使用以及在内存中的加载方式")]),t._v("和静态库都是不同的。")]),t._v(" "),s("p",[t._v("在 cmake 中链接动态库需要用到 "),s("a",{attrs:{href:"https://cmake.org/cmake/help/latest/command/target_link_libraries.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("target_link_libraries"),s("OutboundLink")],1),t._v(" 命令")]),t._v(" "),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-txt"}},[s("code",[t._v("target_link_libraries(<target>\n                      <PRIVATE|PUBLIC|INTERFACE> <item>...\n                     [<PRIVATE|PUBLIC|INTERFACE> <item>...]...)\n")])])]),s("ul",[s("li",[s("code",[t._v("target")]),t._v(" 表示要链接到哪里，即目标。可以是可执行文件或者一个库")]),t._v(" "),s("li",[t._v("后续的参数格式为 "),s("code",[t._v("修饰符 动态库")]),t._v("，不同的修饰符表示不同的权限\n"),s("ul",[s("li",[t._v("如果链接的动态库之间没有依赖关系，则无需做任何设置，"),s("strong",[t._v("一般无需指定")]),t._v("，使用"),s("strong",[t._v("默认的 PUBLIC")]),t._v(" 即可")]),t._v(" "),s("li",[t._v("动态库的链接具有"),s("code",[t._v("传递性")]),t._v("，例如动态库 A 链接了动态库 B 和动态库 C（可表示为 "),s("code",[t._v("target_link_libraries(a, b, c)")]),t._v("），动态库 D 链接了动态库 A，那么此时动态库 D 相当于也链接了动态库 B、C，并可以使用 B 和 C 中定义的方法")]),t._v(" "),s("li",[t._v("权限 "),s("code",[t._v("PUBLIC")]),t._v("：用 public 修饰的库会被链接到 target 中，并且其中的符号也会被导出提供给第三方使用")]),t._v(" "),s("li",[t._v("权限 "),s("code",[t._v("PRIVATE")]),t._v("：用 private 修饰的库仅被链接到 target 中，并且终结掉，第三方无法感知调用了什么库")]),t._v(" "),s("li",[t._v("权限 "),s("code",[t._v("INTERFACE")]),t._v("：用 interface 修饰的库不会被连接到前面的 taget 中，只会导出符号")])])]),t._v(" "),s("li",[s("code",[t._v("target_link_libraries")]),t._v(" 即可用来链接静态库，也可用来链接动态库")])]),t._v(" "),s("p",[t._v("例子：链接之前创建的动态库 "),s("code",[t._v("mycalc")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("helloworld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CMAKE_CXX_STANDARD "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("include"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 链接动态库所在目录（需要放在add_executable命令前）")]),t._v("\nlink_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lib"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 链接动态库到可执行文件")]),t._v("\ntarget_link_libraries"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app mycalc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("注意："),s("code",[t._v("target_link_libraries()")]),t._v(" 语句必须放在"),s("strong",[t._v("最后一行")])]),t._v(" "),s("h3",{attrs:{id:"补充-库的加载工作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#补充-库的加载工作"}},[t._v("#")]),t._v(" 补充：库的加载工作")]),t._v(" "),s("blockquote",[s("p",[t._v("引用 "),s("a",{attrs:{href:"https://subingwen.cn/linux/library/#1-1-%E7%94%9F%E6%88%90%E9%9D%99%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93",target:"_blank",rel:"noopener noreferrer"}},[t._v("Linux 静态库和动态库 | 爱编程的大丙 (subingwen.cn)"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("strong",[t._v("静态库如何被加载")])]),t._v(" "),s("p",[t._v("在程序编译的最后一个阶段也就是链接阶段，提供的"),s("strong",[t._v("静态库会被打包到可执行程序中")]),t._v("。当可执行程序被执行，静态库中的代码也会一并被加载到内存中，因此不会出现静态库找不到无法被加载的问题。")]),t._v(" "),s("p",[t._v("优点：")]),t._v(" "),s("ul",[s("li",[t._v("静态库被打包到应用程序中加载速度快")]),t._v(" "),s("li",[t._v("发布程序无需提供静态库，移植方便")])]),t._v(" "),s("p",[t._v("缺点：")]),t._v(" "),s("ul",[s("li",[t._v("相同的库文件数据可能在内存中被加载多份, 消耗系统资源，浪费内存")]),t._v(" "),s("li",[t._v("库文件更新需要重新编译项目文件, 生成新的可执行程序, 浪费时间。")])]),t._v(" "),s("hr"),t._v(" "),s("p",[s("strong",[t._v("动态库如何被加载")])]),t._v(" "),s("p",[t._v("在程序编译的最后一个阶段也就是"),s("strong",[t._v("链接阶段")]),t._v("：")]),t._v(" "),s("ul",[s("li",[t._v("在 gcc 命令中虽然指定了库路径（使用参数 -L），但是这个路径并没有记录到可执行程序中，"),s("strong",[t._v("只是检查")]),t._v("了这个路径下的库文件是否存在。")]),t._v(" "),s("li",[t._v("同样对应的动态库文件也"),s("strong",[t._v("没有被打包")]),t._v("到可执行程序中，"),s("strong",[t._v("只是在可执行程序中记录了库的名字")]),t._v("。")])]),t._v(" "),s("p",[t._v("可执行程序被执行起来之后:")]),t._v(" "),s("ul",[s("li",[t._v("程序执行的时候会先检测需要的动态库是否可以被加载，加载不到就会提示上边的错误信息")]),t._v(" "),s("li",[t._v("当动态库中的函数在程序中"),s("strong",[t._v("被调用了,")]),t._v(" 这个时候动态库"),s("strong",[t._v("才加载到内存")]),t._v("，如果不被调用就不加载")]),t._v(" "),s("li",[t._v("动态库的检测和内存加载操作都是由动态连接器来完成的")])]),t._v(" "),s("p",[t._v("优点：")]),t._v(" "),s("ul",[s("li",[t._v("可实现不同进程间的资源"),s("strong",[t._v("共享")])]),t._v(" "),s("li",[t._v("动态库升级简单, 只需要替换库文件, 无需重新编译应用程序")]),t._v(" "),s("li",[t._v("程序猿可以控制何时加载动态库, 不调用库函数动态库不会被加载")])]),t._v(" "),s("p",[t._v("缺点：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("加载速度比静态库慢, 以现在计算机的性能可以忽略")])]),t._v(" "),s("li",[s("p",[t._v("发布程序需要提供依赖的动态库")])])]),t._v(" "),s("h2",{attrs:{id:"日志"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#日志"}},[t._v("#")]),t._v(" 日志")]),t._v(" "),s("p",[t._v("可以利用 "),s("a",{attrs:{href:"https://cmake.org/cmake/help/latest/command/message.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("message"),s("OutboundLink")],1),t._v(" 命令记录日志")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("STATUS"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("WARNING"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("AUTHOR_WARNING"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("SEND_ERROR"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("FATAL_ERROR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"message here..."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ul",[s("li",[t._v("不添加模式：表示重要信息")]),t._v(" "),s("li",[s("code",[t._v("STATUS")]),t._v("：表示非重要信息")]),t._v(" "),s("li",[s("code",[t._v("WARNING")]),t._v("：警告，会继续执行")]),t._v(" "),s("li",[s("code",[t._v("AUTHOR_WARNING")]),t._v("：警告（dev），会继续执行")]),t._v(" "),s("li",[s("code",[t._v("SEND_ERROR")]),t._v("：错误，继续执行，跳过生成")]),t._v(" "),s("li",[s("code",[t._v("FATAL_ERROR")]),t._v("：致命错误，终止运行和生成")])]),t._v(" "),s("p",[t._v("例子")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -- source files:/home/.../04proj_use_dynamic_lib/src/main.cpp")]),t._v("\nmessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STATUS "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"source files:"')]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"变量和列表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#变量和列表"}},[t._v("#")]),t._v(" 变量和列表")]),t._v(" "),s("h3",{attrs:{id:"字符串拼接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#字符串拼接"}},[t._v("#")]),t._v(" 字符串拼接")]),t._v(" "),s("p",[t._v("使用 set 命令进行字符串拼接")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STR1 "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NeuralNetwork"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STR2 "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hareware"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STR3 "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"I love "')]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("STR1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" and "')]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("STR2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STATUS $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("STR3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -- I love NeuralNetwork and Hareware")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STR4 "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"I love ${STR1} and ${STR2}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STATUS $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("STR4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -- I love NeuralNetwork and Hareware")]),t._v("\n")])])]),s("h3",{attrs:{id:"list-操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#list-操作"}},[t._v("#")]),t._v(" List 操作")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://cmake.org/cmake/help/latest/command/list.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("list"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("基本操作：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("list([APPEND|LENGTH|GET|REMOVE_ITEM] 操作的变量 参数 [结果变量])\n")])])]),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建 list")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A_LIST apple banana grape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("A_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# applebananagrape")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 向 list 中追加元素")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("APPEND A_LIST "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cake"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("A_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# applebananagrapecake")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取长度")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LENGTH A_LIST LIST_LEN"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"len: ${LIST_LEN}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 4")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取 A_LIST[0]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GET A_LIST "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" LIST_STR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A_LIST[0]: ${LIST_STR}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# apple")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# A_LIST[3]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GET A_LIST "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" LIST_STR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A_LIST[3]: ${LIST_STR}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cake")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 移除元素")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("REMOVE_ITEM A_LIST grape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# A_LIST[2]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GET A_LIST "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" LIST_STR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A_LIST[2]: ${LIST_STR}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cake")]),t._v("\n")])])]),s("p",[t._v("其他操作：在指定位置插入若干元素、将元素插入 i=0 的位置、删除第一个元素、移除最后一个元素、移除指定索引的元素、移除指定元素、移除重复元素、翻转元素、元素排序等等")]),t._v(" "),s("h2",{attrs:{id:"宏定义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#宏定义"}},[t._v("#")]),t._v(" 宏定义")]),t._v(" "),s("p",[t._v("代码所在项目："),s("code",[t._v("05_micro_definition")])]),t._v(" "),s("p",[t._v("在代码中，我们会根据宏定义判断是否执行某一段逻辑，比如")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("<stdio.h>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("process")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"process...\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//有宏定义时才会执行代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("ifdef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token expression"}},[t._v("DEBUG_MODE")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"debugging...\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("endif")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("process")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("为了让测试更灵活，我们可以不在代码中定义宏，而是在 gcc/g++ 命令中指定，比如")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("$ gcc test.c "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-DDEBUG_MODE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" app\n")])])]),s("p",[t._v("在 CMake 中我们不直接配置 gcc/g++，而是在 "),s("code",[t._v("CMakeLists.txt")]),t._v(" 中进行宏定义")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("add_definitions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DDEBUG_MODE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("测试：")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("helloworld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进行宏定义")]),t._v("\nadd_definitions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DDEBUG_MODE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"cmake-嵌套"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cmake-嵌套"}},[t._v("#")]),t._v(" CMake 嵌套")]),t._v(" "),s("p",[t._v("当项目功能比较复杂时，需要进行“模块化”拆分简化，每个模块中包含一个 "),s("code",[t._v("CMakeLists.txt")])]),t._v(" "),s("p",[t._v("比如我们有这样一个“复杂”的项目")]),t._v(" "),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-txt"}},[s("code",[t._v(".\n|-- calc                   <--- 计算工具模块\n|   |-- add.cpp\n|   |-- CMakeLists.txt\n|   |-- div.cpp\n|   |-- mul.cpp\n|   `-- sub.cpp\n|-- CMakeLists.txt\n|-- include                <---- 声明模块\n|   |-- calc.h\n|   `-- sort.h\n|-- sort                   <---- 排序模块\n|   |-- CMakeLists.txt\n|   |-- insert_sort.cpp\n|   `-- select_sort.cpp\n|-- test_calc              <---- 测试模块，测试计算工具\n|   |-- CMakeLists.txt\n|   `-- test_calc.cpp\n`-- test_sort              <---- 测试模块，测试排序工具\n    |-- CMakeLists.txt\n    `-- test_sort.cpp\n")])])]),s("p",[s("strong",[t._v("变量共享")]),t._v("：子节点使用父节点中定义的变量")]),t._v(" "),s("p",[t._v("指定父子关系：使用 "),s("code",[t._v("add_subdirectory")]),t._v(" 命令")]),t._v(" "),s("h3",{attrs:{id:"编写根-cmakelists-txt"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编写根-cmakelists-txt"}},[t._v("#")]),t._v(" 编写根 CMakeLists.txt")]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 定义变量")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1.定义静态库生成路径")]),t._v("\nSET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SLIB_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lib"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2.定义可执行程序的存储路径")]),t._v("\nSET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXE_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 3.定义头文件路径")]),t._v("\nSET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HEAD_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("PROJECT_SOURCE_DIR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("include"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 4.定义库文件名")]),t._v("\nSET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LIB_CALC calc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nSET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LIB_SORT sort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 5.定义可执行文件名")]),t._v("\nSET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("APP_TEST_CALC app_test_calc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nSET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("APP_TEST_SORT app_test_sort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加子目录")]),t._v("\nadd_subdirectory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("calc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nadd_subdirectory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nadd_subdirectory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test_calc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nadd_subdirectory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test_sort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("在此定义的变量可以在子模块中使用")]),t._v(" "),s("h3",{attrs:{id:"calc-和-sort-两个模块的-cmakelists-txt"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#calc-和-sort-两个模块的-cmakelists-txt"}},[t._v("#")]),t._v(" calc 和 sort 两个模块的 CMakeLists.txt")]),t._v(" "),s("p",[s("code",[t._v("calc/CMakeLists.txt")])]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("calc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 搜索所有源文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定头文件")]),t._v("\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("HEAD_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定库输出目录")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LIBRARY_OUTPUT_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SLIB_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 编译静态库。指定库名")]),t._v("\nadd_library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LIB_CALC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" STATIC $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("code",[t._v("sort/CMakeLists.txt")])]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 搜索所有源文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定头文件")]),t._v("\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("HEAD_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定库输出目录")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LIBRARY_OUTPUT_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SLIB_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 编译静态库。指定库名")]),t._v("\nadd_library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LIB_SORT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" STATIC $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"两个测试目录里的-cmakelists-txt"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#两个测试目录里的-cmakelists-txt"}},[t._v("#")]),t._v(" 两个测试目录里的 CMakeLists.txt")]),t._v(" "),s("p",[s("code",[t._v("test_calc/CMakeLists.txt")])]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test_calc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 搜索源文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 包含声明文件目录")]),t._v("\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("HEAD_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 链接静态库")]),t._v("\nlink_libraries"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LIB_CALC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定库目录")]),t._v("\nlink_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SLIB_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定生成程序存储位置")]),t._v("\nSET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXECUTABLE_OUTPUT_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("EXE_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成程序")]),t._v("\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("APP_TEST_CALC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("code",[t._v("test_sort/CMakeLists.txt")])]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test_sort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 搜索源文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 包含声明文件目录")]),t._v("\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("HEAD_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 链接静态库")]),t._v("\nlink_libraries"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LIB_SORT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定库目录")]),t._v("\nlink_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SLIB_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定生成程序存储位置")]),t._v("\nSET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXECUTABLE_OUTPUT_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("EXE_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成程序")]),t._v("\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("APP_TEST_SORT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"执行构建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行构建"}},[t._v("#")]),t._v(" 执行构建")]),t._v(" "),s("p",[t._v("在根目录中创建 build 目录，然后在其中执行 "),s("code",[t._v("cmake ..")]),t._v("，然后执行 "),s("code",[t._v("make")]),t._v(" 命令")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("[engure@ali build]$ cmake .. && make\n-- The C compiler identification is GNU 8.5.0\n-- The CXX compiler identification is GNU 8.5.0\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Check for working C compiler: /usr/bin/cc - skipped\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Check for working CXX compiler: /usr/bin/c++ - skipped\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/engure/cmake_dabing/cmake-tutorials-dabing/06_modulization/build\n[  8%] Building CXX object calc/CMakeFiles/calc.dir/add.cpp.o\n[ 16%] Building CXX object calc/CMakeFiles/calc.dir/div.cpp.o\n[ 25%] Building CXX object calc/CMakeFiles/calc.dir/mul.cpp.o\n[ 33%] Building CXX object calc/CMakeFiles/calc.dir/sub.cpp.o\n[ 41%] Linking CXX static library ../../lib/libcalc.a\n[ 41%] Built target calc\n[ 50%] Building CXX object sort/CMakeFiles/sort.dir/insert_sort.cpp.o\n[ 58%] Building CXX object sort/CMakeFiles/sort.dir/select_sort.cpp.o\n[ 66%] Linking CXX static library ../../lib/libsort.a\n[ 66%] Built target sort\n[ 75%] Building CXX object test_calc/CMakeFiles/app_test_calc.dir/test_calc.cpp.o\n[ 83%] Linking CXX executable ../../bin/app_test_calc\n[ 83%] Built target app_test_calc\n[ 91%] Building CXX object test_sort/CMakeFiles/app_test_sort.dir/test_sort.cpp.o\n[100%] Linking CXX executable ../../bin/app_test_sort\n[100%] Built target app_test_sort\n")])])]),s("h3",{attrs:{id:"在-sort-库中链接-calc-库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在-sort-库中链接-calc-库"}},[t._v("#")]),t._v(" 在 sort 库中链接 calc 库")]),t._v(" "),s("p",[t._v("在 sort 静态库中链接 calc 静态库，只需要保留 "),s("code",[t._v("test_sort")]),t._v(" 一个测试模块即可")]),t._v(" "),s("p",[t._v("项目："),s("code",[t._v("07_modulization_lib_link")])]),t._v(" "),s("p",[t._v("1、指定 sort 库链接 calc 库，"),s("code",[t._v("sort/CMakeLists.txt")])]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("HEAD_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LIBRARY_OUTPUT_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SLIB_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 链接 calc 库")]),t._v("\nlink_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SLIB_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nlink_libraries"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LIB_CALC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nadd_library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LIB_SORT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" STATIC $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("2、在 sort 库中使用 calc 库中的的函数，"),s("code",[t._v("sort/insert_sort.cpp")])]),t._v(" "),s("div",{staticClass:"language-cpp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-cpp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("<stdio.h>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sort.h"')])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//引入声明")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"calc.h"')])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("insert_sort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 调用 add 方法")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"---\\nc=%d\\n---\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" j"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      j "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("j "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("j"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("j "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("j"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          j "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" j "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("j "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("3、一点说明 "),s("code",[t._v("test_sort/CMakeLists.txt")])]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test_sort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("HEAD_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 链接 sort 库以使用其中的排序函数")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   因为 sort 库链接了 calc 库（可理解为 calc 打包到了 sort 库中）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   所以相当于该测试模块也链接了 calc 库，可直接使用 calc 库")]),t._v("\nlink_libraries"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LIB_SORT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nlink_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SLIB_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nSET"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EXECUTABLE_OUTPUT_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("EXE_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nadd_executable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("APP_TEST_SORT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("4、在 "),s("code",[t._v("test_sort")]),t._v(" 测试项目中使用 calc 库，"),s("code",[t._v("test_sort/test_sort.cpp")])]),t._v(" "),s("div",{staticClass:"language-cpp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-cpp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("<stdio.h>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sort.h"')])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"calc.h"')])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" arr1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" arr2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" size "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("insert_sort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arr1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("select_sort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arr2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%d "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" arr1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%d "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" arr2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用 calc 库中的函数")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10 + 20 = %d\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("5、在 build 目录中构建，测试")]),t._v(" "),s("h3",{attrs:{id:"在静态库中链接动态库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在静态库中链接动态库"}},[t._v("#")]),t._v(" 在静态库中链接动态库")]),t._v(" "),s("p",[t._v("拷贝上一节最终的项目代码，命名为 "),s("code",[t._v("08_modulization_lib_link_2")])]),t._v(" "),s("p",[t._v("1、指定 calc 项目最终生成动态库 "),s("code",[t._v("calc/CMakeLists.txt")])]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("calc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("HEAD_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LIBRARY_OUTPUT_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SLIB_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将 STATIC 修改为 SHARED")]),t._v("\nadd_library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LIB_CALC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" SHARED $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("2、在 sort 中链接 calc 动态库 "),s("code",[t._v("sort/CMakeLists.txt")])]),t._v(" "),s("div",{staticClass:"language-py extra-class"},[s("pre",{pre:!0,attrs:{class:"language-py"}},[s("code",[t._v("cmake_minimum_required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VERSION "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nproject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GLOB SRC_LIST "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cpp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ninclude_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("HEAD_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LIBRARY_OUTPUT_PATH $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SLIB_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nlink_directories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SLIB_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成静态库 sort")]),t._v("\nadd_library"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LIB_SORT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" STATIC $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SRC_LIST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 链接动态库 calc 到 sort 静态库")]),t._v("\ntarget_link_libraries"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LIB_SORT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("LIB_CALC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("3、构建项目")]),t._v(" "),s("blockquote",[s("p",[t._v("此时 calc 库并未被打包到 sort 库中，而是保存了符号")])]),t._v(" "),s("h2",{attrs:{id:"项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目"}},[t._v("#")]),t._v(" 项目")]),t._v(" "),s("p",[t._v("内容：使用 cmake 重新构建一个 "),s("a",{attrs:{href:"https://github.com/YY0628/ReactorHttp-cpp",target:"_blank",rel:"noopener noreferrer"}},[t._v("ReactorHttp-Cpp（大丙老师另一个教程）"),s("OutboundLink")],1),t._v(" 项目")]),t._v(" "),s("p",[t._v("步骤：")]),t._v(" "),s("ol",[s("li",[t._v("按照不同功能将文件分组，编写根 cmake 配置文件和子配置文件")]),t._v(" "),s("li",[t._v("子模块有 common、http、reactor、tcp、thread，在构建时都作为静态库单独构建")]),t._v(" "),s("li",[t._v("…")])]),t._v(" "),s("p",[t._v("此章很重要，值得多看 "),s("a",{attrs:{href:"https://www.bilibili.com/video/BV14s4y1g7Zj?p=19",target:"_blank",rel:"noopener noreferrer"}},[t._v("p19"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("checkpoint: "),s("a",{attrs:{href:"https://gitee.com/egu0/cmake-tutorials-dabing/tree/56765f240ffb0daf38fe653beccee6915c9960c7/",target:"_blank",rel:"noopener noreferrer"}},[t._v("cmake-tutorials-dabing: cmake 课程大丙老师 - Gitee.com"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);